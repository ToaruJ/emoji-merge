# emoji merge
这是一个小程序，用来对两个图像进行png融合，生成一幅图像。生成表情特点为：在白色背景下显示“表面图”，在黑色背景显示“隐藏图”。故而在微信，QQ等社交软件时，缩略图显示表面图，而点开大图后显示隐藏图。

### 注意：运行前一定要安装Pillow库！
该程序的运行（图片生成）依赖于PIL库，运行需安装之。

## 算法思想
设表面图（亮图，下方叠放白色背景）需要显示的灰度值为$d_{light} \in [0, 255]$，里图（暗图，下方叠放黑色背景）需要显示的灰度值为$d_{dark} \in [0, 255]$。待求解的合成图是有透明度通道的png图像，其灰度值和不透明度分别是$d \in [0, 255]$和$\alpha \in [0, 1]$。

根据背景叠放规则，可建立方程组
$$\begin{cases}
d \times \alpha = d_{dark} & (暗图)\\
d \times \alpha + 255 \times (1 - \alpha) = d_{light} & (亮图)\\
\end{cases}$$

解方程组得
$$\begin{cases}
\alpha = \frac{1}{255} (255 - d_{light} + d_{dark})\\
d = \frac{d_{dark}}{\alpha}\\
\end{cases}$$

* 注：为使结果有意义（$\alpha$和$d$在设定值域内），需满足条件$d_{light} \ge d_{dark}$。实际程序中会将输入的两幅图像进行线性拉伸，以满足该条件。“亮度调节”功能可以调节两幅图像拉伸时的灰度值交汇点。

## 历代版本
### v1.0
- 完成了该程序最基础的功能，即GUI选取两图像，完成合成算法，保存。
- 该版本仅支持合成黑白图像。
- 拖动“亮度调节”滑块，可对表面图和隐藏图的亮度进行微调。

### v1.0.1
- 对“亮度条”的数字显示作出一些调整，减少无用小数位数。
